---
title: "Анализ данных: Заработная плата и факторы влияния"
author: "Peter Tsivinsky / t.me/tsivi_sky"
date: "2024-12-20"
output: 
  prettydoc::html_pretty:
    theme: architect
    highlight: github
lang: ru-RU
---

# 1. Введение

В этом проекте мы анализируем данные о заработной плате и связанных с ней факторах, чтобы выявить закономерности и сделать выводы, которые могут быть полезны для понимания влияния различных характеристик, таких как опыт работы, уровень образования, должность, а также результаты экзаменов по математике и программированию на уровень дохода.

Основной задачей является продемонстрировать подходы к обработке и анализу данных с использованием языка программирования R, включая визуализацию результатов и выводы.

# 2. Загрузка библиотек и данных
## 2.1 Подключение библиотек

Для начала подключим необходимые библиотеки. Мы будем использовать `tidyverse` для обработки данных и визуализации, а также `skimr` для описательной статистики.

```{r setup, message=FALSE, warning=FALSE}
# Установите пакеты, если они не установлены
# install.packages(c("tidyverse", "skimr", "readr"))

library(tidyverse)
library(skimr)
```

## 2.2 Загрузка данных

Данные находятся в файле `Salary_Data.csv`. Мы используем функцию `read_csv` для их загрузки. 
Для установки рабочей директории можно было бы воспользоваться `setwd`, но в таком варианте мы бы привязывались к структуре директорий на своём текущем рабочем месте и придётся редактировать проект, чтобы посмотреть его на другом компьютере. Поэтому лучше загрузить датасет на облачное хранилище и импортировать данные прямо оттуда.

```{r load-data}
# Путь к файлу данных
file_path <- "https://raw.githubusercontent.com/wowxoxo/r-lang_project/refs/heads/master/data/Salary_Data.csv"

# Загрузка данных
salary_data <- read_csv(file_path)

# Проверим, что данные успешно загружены
head(salary_data)
```

### Наблюдения:
1. Данные успешно загружены. Таблица содержит такие переменные, как `Age`, `Salary`, `Years of Experience`, `Math exam score`, `Programming exam score`, `Gender`, `Education Level`, и `Job Title`.
2. Первые строки показывают, что данные выглядят корректными и готовы для анализа.

# 3. Первичная проверка данных

На этом этапе мы изучим структуру данных, проверим количество строк и столбцов, а также выявим потенциальные проблемы, такие как пропуски или некорректные типы даных.

```{r inspect-data}
# Структура данных
str(salary_data)

# Количество строк и столбцов
cat("Количество строк:", nrow(salary_data), "\n")
cat("Количество столбцов:", ncol(salary_data), "\n")

# Описательная статистика
skim(salary_data)
```

### Наблюдения:
1. **Типы данных:** Столбцы содержат числовые переменные, такие как `Age`, `Salary`, и `Years of Experience`, а также категориальные переменные, включая `Gender`, `Education Level`, и `Job Title`. Типы данных определены корректно.
2. **Размер данных:** Набор данных включает 6698 строк и 8 столбцов, что соответствует требованиям.
3. **Пропуски:** Пропуски отсутствуют, что подтверждает высокое качество набора данных.
4. **Распределения:** С помощью `skim()` видно, что данные распределены достаточно широко, особенно для таких переменных, как зарплата и опыт работы, что обещает интересные инсайты при дальнейшем анализе.

# 4. Предобработка данных
## 4.1 Приведение названий колонок к нижнему регистру

Названия столбцов приводим к единому формату для удобства работы.

```{r clean-names}
# Приведение названий к нижнему регистру
names(salary_data) <- tolower(names(salary_data))

# Проверяем изменения
names(salary_data)
```

## 4.2 Преобразование названий столбцов
```{r rename columns}
# Установим и подключим janitor, если он ещё не установлен
# install.packages("janitor")
library(janitor)

# Преобразование всех имен столбцов к удобному формату
salary_data <- salary_data %>% clean_names()

# Проверим результат
colnames(salary_data)

```

Комментарии:
- Все названия столбцов преобразованы в нижний регистр с заменой пробелов на подчёркивания (_).
- Например, `years of experience` теперь стало `years_of_experience`, а `math exam score` — `math_exam_score`.

## 4.3 Обработка пропусков

Если в данных есть пропуски, мы их обрабатываем. Например, можно удалить строки с пропусками или заполнить их средним значением.

```{r handle-missing}
# Проверка пропусков
colSums(is.na(salary_data))

# В данном случае пропусков нет, но если бы они были, можно применить следующий код:
# salary_data <- salary_data %>% drop_na()
```

### Комментарии:
Пропуски в данных отсутствуют, поэтому дополнительная обработка не требуется.

# 5. Фильтрация данных

Например, мы можем оставить только записи, где `salary` выше определённого порога.

```{r filter-data}
# Пример фильтрации данных
example_filtered_data <- salary_data %>% filter(salary > 50000)

# Проверим результат фильтрации
nrow(example_filtered_data)

# это просто пример, будем работать с полным датасетом, без фильтрации
```


# 6. Описательная статистика
## 6.1 Описательные статистики для числовых переменных

```{r numerical cols}
# Описательные статистики для числовых переменных
summary(select(salary_data, age, years_of_experience, salary, math_exam_score, programming_exam_score))

```

### Наблюдения:
- `Age`: Средний возраст — 33.6 лет, диапазон значений — от 21 до 62.
- `Years of Experience`: Средний опыт — 8.1 лет, с разбросом от 1 до 34.
- `Salary`: Средняя зарплата составляет 115,329, с диапазоном от 20,000 до 250,000.
- `Math exam score` и `Programming exam score` распределены схожим образом, с близкими средними значениями (65.8 и 67.0) и небольшими разбросами.

## 6.2 Частоты для категориальных переменных
```{r categorical cols}
cat("Gender:\n")
print(table(salary_data$gender))

cat("\nEducation Level:\n")
print(table(salary_data$education_level))

cat("\nJob Title:\n")
print(salary_data %>%
  count(job_title))

cat("\nJob Title (Top 10):\n")
print(head(sort(table(salary_data$job_title), decreasing = TRUE), 10))
```

### Наблюдения:
- `Gender` содержит 6 уникальных значений.
- `Education Level` имеет 7 уникальных категорий.
- `Job Title` включает 191 уникальное значение, что указывает на большое разнообразие должностей.


## 6.3 Анализ поля gender

В данных присутствует 3 уникальных значения в поле gender. Это может указывать на некорректные данные или опечатки. Давайте изучим их подробнее.

### Проверка уникальных значений
Используем функцию `unique()` для вывода всех уникальных значений поля gender.

```{r unique gender}

unique(salary_data$gender)

```

Видим значение Other, скорее всего кто-то не указал пол при проведении исследований. Проверим насколько их много, чтобы оценить влияние на датасет

```{r d}
# Частоты значений в поле gender
table(salary_data$gender)

```

Всего 14 значений, совсем мало по сравнению с остальными. Можно было бы удалить строки с этимм значениями, но не будем.

## 6.4 Визуализация распределения gender
Построим круговую диаграмму для переменной gender, чтобы наглядно представить её распределение.

```{r gender pie}
# Создаём таблицу с подсчётом частот
gender_counts <- salary_data %>%
  count(gender)

# Построение круговой диаграммы
ggplot(gender_counts, aes(x = "", y = n, fill = gender)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y", start = 0) +
  theme_void() +
  labs(title = "Распределение по полу", fill = "Gender") +
  geom_text(aes(label = paste0(round(n / sum(n) * 100, 1), "%")), 
            position = position_stack(vjust = 0.5))


```


### Наблюдения:
- `Male`: Составляют 54.8% выборки — это наиболее распространённое значение в поле gender.
- `Female`: Представляют 45% данных, что немного меньше по сравнению с Male.
- `Other`: Составляют всего 0.2% выборки. Эта категория, вероятно, связана с некорректным вводом данных или редкими случаями.

Данное распределение показывает, что мужчины и женщины представлены почти равномерно.


## 6.5 Анализ поля education_level
Теперь мы рассмотрим поле `education_level`, чтобы понять его распределение и возможные особенности. Сначала выведем уникальные значения и построим таблицу частот.

```{r unique edu}
unique(salary_data$education_level)

```

Некоторые значения очень похожи, отобразим их на графике, что увидеть более явно:


```{r education pie}
# Создаём таблицу с подсчётом частот
education_counts <- salary_data %>%
  count(education_level)

# Построение круговой диаграммы
ggplot(education_counts, aes(x = "", y = n, fill = education_level)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y", start = 0) +
  theme_void() +
  labs(title = "Распределение по уровню образования", fill = "Education level") +
  geom_text(aes(label = paste0(round(n / sum(n) * 100, 1), "%")), 
            position = position_stack(vjust = 0.5))


```

Хорошо, теперь проблема очевидна. Один и тот же уровень образования называется по-разному. Значения должны быть санитизированы.


## 7. Стандартизация колонки education_level

Создадим явный маппинг для всех значений и приведём их к нужному формату:
```{r edu mapping}
# Явное сопоставление значений
salary_data <- salary_data %>%
  mutate(education_level = case_when(
    education_level == "Bachelor's Degree" ~ "Bachelor's",
    education_level == "Bachelor's" ~ "Bachelor's",
    education_level == "Master's Degree" ~ "Master's",
    education_level == "Master's" ~ "Master's",
    education_level == "PhD" ~ "PhD",
    education_level == "phD" ~ "PhD",
    education_level == "High School" ~ "High School",
    TRUE ~ education_level # Для любых других значений
  ))

# Проверка результата
table(salary_data$education_level)

```

### Комментарии:
- Значения в `education_level` теперь приведены к стандартным категориям:
  - `Bachelor's`
  - `Master's`
  - `PhD`
  - `High School`
- Явное сопоставление устранило дублирующиеся и некорректные значения (например, `phD` → `PhD`).

## 7.1 Распределение уровня образования

```{r education pie 2}
# Создаём таблицу с подсчётом частот
education_counts2 <- salary_data %>%
  count(education_level)

# Построение круговой диаграммы
ggplot(education_counts2, aes(x = "", y = n, fill = education_level)) +
  geom_bar(stat = "identity", width = 1) +
  coord_polar("y", start = 0) +
  theme_void() +
  labs(title = "Распределение по уровню образования", fill = "Education level") +
  geom_text(aes(label = paste0(round(n / sum(n) * 100, 1), "%")), 
            position = position_stack(vjust = 0.5))


```

Данные показывают, что большинство людей имеют степень бакалавра или магистра, а уровень образования `PhD` также заметно распространён. Минимальное количество людей с `High School` указывает на то, что более высокие уровни образования являются нормой для рассматриваемых должностей.


## 8. Анализ `job_title`: роли с префиксом `Junior`
Поле `job_title` содержит множество уникальных значений. Для интереса исследуем, сколько позиций имеют префикс `Junior` и составляют ли они значительную долю среди всех должностей.

### 8.1 Проверка случайной выборки должностей
Выведем случайную выборку из `job_title`, чтобы оценить данные:

```{r job seed}
# Случайная выборка 5 должностей
set.seed(123)  # Для воспроизводимости
sample_n(distinct(salary_data, job_title), 10)
```

### 8.2 Позиции с префиксом `Junior`
Фильтрация должностей с `Junior`
```{r junior positions filter}
# Фильтрация должностей с "Junior"
junior_job_titles <- salary_data %>%
  filter(str_detect(job_title, regex("Junior", ignore_case = TRUE)))

# Количество должностей с "Junior"
junior_job_title_counts <- junior_job_titles %>%
  count(job_title, sort = TRUE)

# Просмотр результата
junior_job_title_counts

```

### 8.3 Общее число позиций с `Junior`
Подсчёт общего числа позиций с `Junior`
```{r junior positions count}
# Подсчёт общего числа позиций с "Junior"
total_junior_jobs <- nrow(junior_job_titles)
cat("Total number of job titles containing 'Junior':", total_junior_jobs, "\n")

```

### 8.4 Процент позиций с `Junior`
Расчёт процента позиций с `Junior`
```{r junior positions percentage}
# Общее число должностей
total_jobs <- nrow(salary_data)

# Расчёт процента должностей с "Junior"
percent_junior_jobs <- (total_junior_jobs / total_jobs) * 100
cat("Percentage of 'Junior' job titles:", round(percent_junior_jobs, 2), "%\n")

```

### Наблюдения:

Примерно 8% всех позиций в наборе данных относятся к начальному или раннему уровню карьеры.

Это говорит о том, что выборка больше ориентирована на должности среднего и старшего уровня, но включает достаточное количество начальных позиций.

Выборка с Junior подтверждает наличие разнообразных должностей, подходящих для начинающих специалистов.


# 9. Визуализация и исследование
Мы уже создали несколько визуализаций. Теперь рассмотрим распределение зарплат и вычислим центральные тенденции и разброс.


## 9.1 Распределение зарплат
Центральные тенденции и разброс

```{r salary dist}
# Вычисление среднего, медианы и стандартного отклонения для зарплат
salary_mean <- mean(salary_data$salary, na.rm = TRUE)
salary_median <- median(salary_data$salary, na.rm = TRUE)
salary_std <- sd(salary_data$salary, na.rm = TRUE)

# Вывод результатов
cat("Mean Salary:", salary_mean, "\n")
cat("Median Salary:", salary_median, "\n")
cat("Standard Deviation of Salary:", salary_std, "\n")

```

## Наблюдения:
1. Средняя зарплата (Mean Salary): 115,329.25. Это среднее значение зарплат в наборе данных.
2. Медианная зарплата (Median Salary): 115,000. Значение медианы близко к среднему, что указывает на относительно сбалансированное распределение зарплат.
3. Стандартное отклонение (Standard Deviation): 52,789.79. Высокое значение стандартного отклонения показывает широкий диапазон зарплат и значительные различия между ними.

# 9.1.1 Гистограмма распределения зарплат
```{r salary dist hist}
# Построение гистограммы распределения зарплат
ggplot(salary_data, aes(x = salary)) +
  geom_histogram(bins = 20, fill = "lightblue", color = "black") +
  labs(
    title = "Распределение зарплат",
    x = "Зарплата",
    y = "Частота"
  ) +
  theme_minimal()

```

Странные подписи у оси X, попробуем это исправить с пакетом scales():
```{r salary dist hist fixed x}
# Установите пакет scales, если он не установлен
# install.packages("scales")
library(scales)

# Построение гистограммы с отформатированной осью X
ggplot(salary_data, aes(x = salary)) +
  geom_histogram(bins = 20, fill = "lightblue", color = "black") +
  scale_x_continuous(
    labels = scales::label_comma(),  # Форматирование в виде чисел с запятыми
    breaks = seq(0, max(salary_data$salary, na.rm = TRUE), by = 50000) # Шаг 50,000
  ) +
  labs(
    title = "Распределение зарплат",
    x = "Зарплата",
    y = "Частота"
  ) +
  theme_minimal()

```

Отлично, так намного нагляднее.

## Наблюдения из визуализации:
1. Зарплаты в основном сконцентрированы в диапазоне от 50,000 до 200,000, с меньшим количеством людей, получающих очень низкие или очень высокие зарплаты.
2. Наличие высоких зарплат (до 250,000) указывает на то, что в наборе данных представлены роли старшего уровня или специализированные позиции, которые получают значительно больше.


## 9.2 Salary vs Years of Experience
Построим диаграмму рассеяния (scatter plot), чтобы визуализировать связь между опытом работы (`years_of_experience`) и зарплатой (`salary`).

```{r salary vs exp}
# Построение scatter plot
ggplot(salary_data, aes(x = years_of_experience, y = salary)) +
  geom_point(alpha = 0.5, color = "blue") +
  labs(
    title = "Опыт работы vs Зарплата",
    x = "Опыт работы (лет)",
    y = "Зарплата"
  ) +
  theme_minimal()

```

## Наблюдения:
1. Положительная корреляция: На диаграмме видно, что зарплата, как правило, увеличивается с ростом опыта работы. Это подтверждает гипотезу о том, что опыт играет важную роль в определении зарплаты.
2. Неидеальная линейность:
    - Есть аутлайеры: люди с высокой зарплатой, несмотря на небольшой опыт работы.
    - Также есть люди с низкой зарплатой, несмотря на значительный опыт.
3. Вариация зарплат: На всех уровнях опыта заметен разброс зарплат, что указывает на влияние других факторов, таких как должность, уровень образования или отрасль.


## 9.3 Education и Salary
Построим boxplot, чтобы изучить распределение зарплат для каждой категории уровня образования (`education_level`). Это поможет визуализировать медиану, межквартильный размах и выбросы для каждой группы.

```{r edu vs salary}
# Построение boxplot
ggplot(salary_data, aes(x = education_level, y = salary)) +
  geom_boxplot(fill = "lightblue", color = "black", outlier.color = "blue", outlier.shape = 16) +
  labs(
    title = "Распределение зарплат по уровню образования",
    x = "Уровень образования",
    y = "Зарплата"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```


### Интерпретация:
1. `PhD`: Обладатели степени `PhD` имеют самую высокую медианную зарплату, что подтверждает, что этот уровень образования связан с более высокими доходами.
2. `Master's Degree`: Люди с магистерской степенью также имеют высокие зарплаты, хотя их диапазон несколько шире, чем у `PhD`.
3. `Bachelor's Degree`: Медианная зарплата ниже, чем у обладателей продвинутых степеней, но диапазон показывает, что многие бакалавры зарабатывают на уровне магистров.
4. `High School`: Выпускники средней школы имеют самую низкую медианную зарплату и ограниченный диапазон, что говорит о меньших возможностях для высоких доходов.

### Наблюдения:
1. Зарплата, как правило, увеличивается с ростом уровня образования: обладатели степеней `PhD` и `Master's` получают больше, чем `Bachelor's` или выпускники средней школы.
2. Несмотря на тренд, есть значительное пересечение в распределении зарплат. Некоторые обладатели `Bachelor's` получают столько же, сколько магистры .
3. Широкий диапазон зарплат для всех уровней образования показывает, что помимо образования на зарплату влияют такие факторы, как опыт и должность.


## 9.4 Распределение возраста
В этом разделе мы вычислим центральные тенденции и разброс возраста (`age`) и визуализируем его распределение.

### Центральные тенденции и разброс

```{r age dist}
# Вычисление среднего, медианы и стандартного отклонения для возраста
age_mean <- mean(salary_data$age, na.rm = TRUE)
age_median <- median(salary_data$age, na.rm = TRUE)
age_std <- sd(salary_data$age, na.rm = TRUE)

# Вывод результатов
cat("Mean Age:", age_mean, "\n")
cat("Median Age:", age_median, "\n")
cat("Standard Deviation of Age:", age_std, "\n")

```

### Построение гистограммы распределения возраста

```{r age dist hist}
# Построение гистограммы распределения возраста
ggplot(salary_data, aes(x = age)) +
  geom_histogram(bins = 20, fill = "lightgreen", color = "black") +
  labs(
    title = "Распределение возраста",
    x = "Возраст",
    y = "Частота"
  ) +
  theme_minimal()

```

#### Интерпретация:
1. Центральные тенденции:
    - Средний возраст — 33.6 лет.
    - Медианный возраст — 32 года.
    - Поскольку среднее и медиана близки, распределение выглядит относительно симметричным.

2. Разброс: Стандартное отклонение составляет 7.62, что говорит о умеренном разбросе возрастов в выборке.

3. Распределение:
Большинство людей находятся в возрасте от 20 до 40 лет, что отражает рабочую популяцию, находящуюся в середине своей карьеры.
Меньше людей представлено в возрастных группах старше 50 или младше 25 лет.

# 10. Более глубокое исследование и вопросы для анализа
## 10.1 Распределение мужчин и женщин на разных должностях
### Шаг 1: Топ-5 самых популярных должностей
```{r job/gender dist}
# Топ-5 самых популярных должностей
top_5_job_titles <- salary_data %>%
  count(job_title, sort = TRUE) %>%
  top_n(5, n)

# Выводим результат
top_5_job_titles

```

### Шаг 2: Распределение по полу для топ-5 должностей
```{r job/gender top}
# Фильтрация данных для топ-5 должностей и подсчёт распределения по полу
gender_job_distribution <- salary_data %>%
  filter(job_title %in% top_5_job_titles$job_title) %>%
  count(job_title, gender) %>%
  pivot_wider(names_from = gender, values_from = n, values_fill = 0)

# Выводим результат
gender_job_distribution

```


### Шаг 3: Визуализация распределения (Stacked Bar Chart)
```{r job/gender stacked bar}
# Построение stacked bar chart для распределения по полу
ggplot(gender_job_distribution, aes(x = job_title)) +
  geom_bar(aes(y = Male, fill = "Male"), stat = "identity", position = "stack") +
  geom_bar(aes(y = Female, fill = "Female"), stat = "identity", position = "stack") +
  scale_fill_manual(values = c("Male" = "lightblue", "Female" = "pink"), name = "Gender") +
  labs(
    title = "Распределение мужчин и женщин в топ-5 должностей",
    x = "Должность",
    y = "Количество сотрудников"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

### Наблюдения:
Гендерный дисбаланс наблюдается в технических и инженерных ролях, таких как `Software Engineer Manager`, с преобладанием мужчин. Для позиции `Data Scientist` видно преобладание женщин.
Другие роли демонстрируют более равное представительство.

## 10.2 Влияет ли опыт на зарплату?
Для проверки влияния опыта работы (`years_of_experience`) на зарплату (`salary`), построим диаграмму рассеяния и вычислим корреляцию между этими переменными.

### Построение диаграммы рассеяния
```{r exp/sal plot}
# Построение scatter plot
ggplot(salary_data, aes(x = years_of_experience, y = salary)) +
  geom_point(alpha = 0.5, color = "blue") +
  labs(
    title = "Опыт работы vs Зарплата",
    x = "Опыт работы (лет)",
    y = "Зарплата"
  ) +
  theme_minimal()

```

### Вычисление корреляции
```{r exp/sal corr}
# Вычисление корреляции между опытом работы и зарплатой
experience_salary_corr <- cor(salary_data$years_of_experience, salary_data$salary, use = "complete.obs")

# Вывод результата
cat("Correlation between experience and salary:", experience_salary_corr, "\n")

```

### Наблюдения:
1. Чёткая положительная связь: График подтверждает, что с ростом опыта работы зарплата, как правило, увеличивается.
Основная масса данных соответствует ожидаемой тенденции.

2. Разброс данных:
На низком уровне опыта (0–10 лет) зарплаты варьируются в широком диапазоне от 20,000 до 150,000, что указывает на влияние других факторов, таких как должность или образование.
Для среднего опыта (10–20 лет) распределение становится более концентрированным, но всё же присутствуют выбросы.

3. Насыщенность данных:
В верхнем диапазоне опыта (20+ лет) зарплаты имеют меньше вариаций, концентрируясь около 150,000–200,000.
Однако встречаются аномалии, где люди с большим опытом имеют зарплаты ниже ожидаемого уровня.

4. Корреляция:
Корреляция 0.81 подтверждает, что опыт работы является важным фактором, влияющим на зарплату.
Несмотря на сильную связь, присутствие выбросов показывает, что другие факторы, такие как отрасль, регион или тип компании, также оказывают значительное влияние.

## 10.3 Влияют ли результаты экзаменов по математике и программированию на зарплату?
Мы проверим, есть ли связь между результатами экзаменов по математике и программированию (`math_exam_score`, `programming_exam_score`) и зарплатой (`salary`).

### 10.3.1 `Math Exam Score` vs. `Salary`
Построение диаграммы рассеяния
```{r math exam vs salary dist}
# Диаграмма рассеяния для Math Exam Score vs Salary
ggplot(salary_data, aes(x = math_exam_score, y = salary)) +
  geom_point(alpha = 0.5, color = "red") +
  labs(
    title = "Результат экзамена по математике vs Зарплата",
    x = "Результат экзамена по математике",
    y = "Зарплата"
  ) +
  theme_minimal()

```

Корреляция между математикой и зарплатой
```{r math exam vs salary corr}
# Вычисление корреляции между Math Exam Score и Salary
math_salary_corr <- cor(salary_data$math_exam_score, salary_data$salary, use = "complete.obs")

# Вывод результата
cat("Correlation between Math exam score and Salary:", math_salary_corr, "\n")

```

#### Наблюдения `Math Exam Score` vs. `Salary`:
Диаграмма рассеяния показывает отсутствие явной тенденции (восходящей или нисходящей), что указывает на слабую связь между результатами экзаменов по математике и зарплатой.
Коэффициент корреляции составляет 0.02, что близко к нулю и подтверждает отсутствие значимой зависимости.

### 10.3.2 `Programming Exam Score` vs. `Salary`
Построение диаграммы рассеяния
```{r program exam vs salary dist}
# Диаграмма рассеяния для Programming Exam Score vs Salary
ggplot(salary_data, aes(x = programming_exam_score, y = salary)) +
  geom_point(alpha = 0.5, color = "green") +
  labs(
    title = "Результат экзамена по программированию vs Зарплата",
    x = "Результат экзамена по программированию",
    y = "Зарплата"
  ) +
  theme_minimal()

```

Корреляция между программированием и зарплатой
```{r program exam vs salary corr}
# Вычисление корреляции между Programming Exam Score и Salary
prog_salary_corr <- cor(salary_data$programming_exam_score, salary_data$salary, use = "complete.obs")

# Вывод результата
cat("Correlation between Programming exam score and Salary:", prog_salary_corr, "\n")

```

#### Наблюдения `Programming Exam Score` vs. `Salary`:

Аналогично, диаграмма рассеяния для результатов экзамена по программированию также не демонстрирует чёткой связи с зарплатой.
Коэффициент корреляции равен -0.02, что подтверждает слабую или отсутствующую зависимость.

### Выводы:

Ни результаты экзаменов по математике, ни по программированию не оказывают значимого влияния на зарплату.
На уровень зарплаты, вероятно, больше влияют такие факторы, как опыт работы, образование и должность.


## 10.4 Связь между результатами экзаменов по математике и программированию
Мы проверим, существует ли связь между результатами экзаменов по математике (`math_exam_score`) и программированию (`programming_exam_score`) с помощью диаграммы рассеяния и корреляции.

Построение диаграммы рассеяния
```{r math vs program dist}
# Диаграмма рассеяния для Math Exam Score vs Programming Exam Score
ggplot(salary_data, aes(x = math_exam_score, y = programming_exam_score)) +
  geom_point(alpha = 0.5, color = "purple") +
  labs(
    title = "Результат экзамена по математике vs экзамена по программированию",
    x = "Результат экзамена по математике",
    y = "Результат экзамена по программированию"
  ) +
  theme_minimal()

```

Вычисление корреляции
```{r math vs program corr}
# Вычисление корреляции между Math Exam Score и Programming Exam Score
math_prog_corr <- cor(salary_data$math_exam_score, salary_data$programming_exam_score, use = "complete.obs")

# Вывод результата
cat("Correlation between Math and Programming exam scores:", math_prog_corr, "\n")

```

### Наблюдения:


1. Диаграмма рассеяния:
Точки на графике демонстрируют чёткую положительную зависимость между результатами экзаменов по математике и программированию.
Большинство точек лежат вдоль диагональной линии, что подтверждает высокую корреляцию между двумя переменными.

2. Корреляция:
Коэффициент корреляции, составляет 0.82, что указывает на сильную положительную связь.
Это подтверждает, что навыки, необходимые для экзаменов по математике и программированию, тесно связаны.

3. Выводы:
Люди с высокими баллами по математике, как правило, показывают аналогично высокие результаты по программированию.
Низкие баллы по математике также часто сопровождаются низкими баллами по программированию.
Это может свидетельствовать о том, что базовые навыки, такие как аналитическое мышление или логика, одинаково важны для обоих экзаменов.


## 10.5 Влияет ли уровень образования на опыт работы?
Мы исследуем связь между уровнем образования (`education_level`) и средним опытом работы (`years_of_experience`), вычислим средние значения и визуализируем их.

Средний опыт работы по уровням образования
```{r edu vs exp}
# Группировка по уровню образования и расчёт среднего опыта работы
education_experience <- salary_data %>%
  group_by(education_level) %>%
  summarise(avg_years_experience = mean(years_of_experience, na.rm = TRUE))

# Вывод результатов
education_experience

```


Визуализация: Столбчатая диаграмма
```{r edu vs exp bar}
# Построение столбчатой диаграммы
ggplot(education_experience, aes(x = education_level, y = avg_years_experience)) +
  geom_bar(stat = "identity", fill = "orange") +
  labs(
    title = "Средний опыт работы по уровню образования",
    x = "Уровень образования",
    y = "Средний опыт работы (лет)"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

### Наблюдения:
1. Положительная связь между образованием и опытом:
Люди с более высоким уровнем образования, такими как `PhD` и `Master's`, имеют больше среднего опыта работы.
`PhD` демонстрирует наибольший средний опыт работы, превышающий 13 лет.

2. Бакалавриат (`Bachelor's`):
Уровень Bachelor's имеет средний опыт около 5–6 лет, что меньше, чем у тех, кто завершил магистратуру или докторантуру.

3. Средняя школа (`High School`):
Люди с уровнем High School имеют самый низкий средний опыт работы, около 2 лет.
Это может быть связано с тем, что эти люди рано выходят на рынок труда и, возможно, имеют меньше возможностей для карьерного роста по сравнению с обладателями высших степеней.

#### Выводы
Более высокие уровни образования требуют больше времени на обучение, что часто означает, что люди старше и имели больше времени для накопления опыта.
Дополнительно, продвинутые ступени образования могут открывать доступ к более длительной и стабильной занятости.


## 10.6 Различия в зарплатах в зависимости от уровня образования и должности

Мы исследуем, существуют ли различия в средней зарплате в зависимости от комбинации уровня образования (`education_level`) и должности (`job_title`).

Средняя зарплата по уровням образования и должностям
```{r edu vs title}
# Группировка по job_title и education_level и расчёт средней зарплаты
job_education_salary <- salary_data %>%
  group_by(job_title, education_level) %>%
  summarise(avg_salary = mean(salary, na.rm = TRUE)) %>%
  pivot_wider(names_from = education_level, values_from = avg_salary)

# Просмотр результата
job_education_salary

```


Визуализация: Тепловая карта
```{r edu vs title heatmap}
# Установка пакета для тепловых карт (если не установлен)
# install.packages("reshape2")

library(reshape2)

# Преобразование данных для визуализации
job_education_salary_long <- melt(as.data.frame(job_education_salary), id.vars = "job_title", variable.name = "education_level", value.name = "avg_salary")

# Построение тепловой карты
ggplot(job_education_salary_long, aes(x = education_level, y = job_title, fill = avg_salary)) +
  geom_tile(color = "white") +
  scale_fill_gradient(low = "white", high = "blue", na.value = "grey") +
  labs(
    title = "Средняя зарплата по уровню образования и должности",
    x = "Уровень образования",
    y = "Должность",
    fill = "Средняя зарплата"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

Очень сложно воспринимать такой график, попробуем его немного настроить:

```{r edu vs title heatmap 2}
# Фильтрация для топ-10 должностей с самой высокой средней зарплатой
top_jobs <- salary_data %>%
  group_by(job_title) %>%
  summarise(avg_salary = mean(salary, na.rm = TRUE)) %>%
  arrange(desc(avg_salary)) %>%
  slice_head(n = 10) %>%
  pull(job_title)

# Отбор данных только для топ-10 должностей
filtered_job_education_salary <- salary_data %>%
  filter(job_title %in% top_jobs) %>%
  group_by(job_title, education_level) %>%
  summarise(avg_salary = mean(salary, na.rm = TRUE)) %>%
  pivot_wider(names_from = education_level, values_from = avg_salary)

# Преобразование данных в формат для тепловой карты
filtered_job_education_salary_long <- melt(as.data.frame(filtered_job_education_salary), id.vars = "job_title", variable.name = "education_level", value.name = "avg_salary")

# Построение обновлённой тепловой карты
ggplot(filtered_job_education_salary_long, aes(x = education_level, y = job_title, fill = avg_salary)) +
  geom_tile(color = "white") +
  scale_fill_gradient(low = "white", high = "blue", na.value = "grey") +
  labs(
    title = "Средняя зарплата (топ-10 должностей)",
    x = "Уровень образования",
    y = "Должность",
    fill = "Средняя зарплата"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

### Наблюдения:

1. **Связь между уровнем образования и зарплатой**:
   - У `CEO`, неожиданно, самая высокая средняя зарплата связана с уровнем образования `Bachelor's`, а не с `PhD` или `Master's`. Это может быть вызвано специфическими характеристиками выборки или уникальными карьерными траекториями.
   - Для таких должностей, как `Chief Technology Officer` и `Chief Data Officer`, степень `PhD` явно связана с более высокими зарплатами.

2. **Исключения**:
   - Должности, такие как `VP of Operations` и `VP of Finance`, демонстрируют слабую зависимость зарплаты от уровня образования. Возможно, на этих ролях большее значение имеют навыки управления и опыт.

3. **Выделяющиеся роли**:
   - У `Chief Technology Officer` и `Chief Data Officer` степень `PhD` даёт значительное преимущество в зарплате.
   - Напротив, для ролей `Director` и `Marketing Director` влияние образования на зарплату минимально.

4. **Выводы**:
   - Хотя в большинстве случаев высшее образование приводит к более высоким зарплатам, есть исключения, такие как `CEO`, где фактор образования играет меньшую роль, и, возможно, большее влияние оказывают лидерские качества и опыт.



# 11. Сводные таблицы
## 11.1 Гендер vs Уровень образования – Анализ зарплат
Мы создадим сводную таблицу для анализа зависимости средней зарплаты от пола (`gender`) и уровня образования (`education_level`), а также визуализируем данные с помощью тепловой карты.

Сводная таблица: Средняя зарплата по полу и уровню образования
```{r gender vs edu pivot}
# Создание сводной таблицы
gender_education_pivot <- salary_data %>%
  group_by(gender, education_level) %>%
  summarise(avg_salary = mean(salary, na.rm = TRUE)) %>%
  pivot_wider(names_from = education_level, values_from = avg_salary)

# Просмотр результата
gender_education_pivot

```

Визуализация: Тепловая карта
```{r gender vs edu heatmap}
# Преобразование данных в формат для тепловой карты
gender_education_long <- melt(as.data.frame(gender_education_pivot), id.vars = "gender", variable.name = "education_level", value.name = "avg_salary")

# Построение тепловой карты
ggplot(gender_education_long, aes(x = education_level, y = gender, fill = avg_salary)) +
  geom_tile(color = "white") +
  scale_fill_gradient(low = "white", high = "red", na.value = "grey") +
  labs(
    title = "Средняя зарплата по полу и уровню образования",
    x = "Уровень образования",
    y = "Пол",
    fill = "Средняя зарплата"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 45, hjust = 1))

```

### Наблюдения:
1. Увеличение зарплаты с уровнем образования:
Зарплата возрастает с ростом уровня образования для всех категорий пола.
Обладатели степени `PhD` получают самые высокие зарплаты, независимо от пола.

2. Гендерные различия:
Мужчины (`Male`) получают более высокую среднюю зарплату по сравнению с женщинами (`Female`) на всех уровнях образования, особенно заметно на уровнях `Master's` и `PhD`.
Категория Other имеет меньше данных (серые ячейки), что ограничивает возможности анализа.

3. Самая высокая зарплата:
PhD среди мужчин показывает наибольшую среднюю зарплату, превышающую 160,000.

4. Зависимость от уровня образования:
Для женщин и мужчин зарплаты стабильно увеличиваются от `High School` к `PhD`, подчёркивая значимость образования.

Гендерный разрыв в зарплатах присутствует, но его выраженность зависит от уровня образования. Например, разрыв становится особенно заметным на уровне `Master's` и `PhD`.


# 11.2 Сводная таблица для опыта и зарплаты по уровню образования

Мы создадим сводную таблицу, чтобы проанализировать средние значения опыта работы (`years_of_experience`) и зарплаты (`salary`) по уровням образования (`education_level`).

Сводная таблица: Опыт и зарплата по уровням образования
```{r exp vs salary vs edu pibot}
# Группировка по уровню образования и расчёт среднего опыта и зарплаты
experience_salary_pivot <- salary_data %>%
  group_by(education_level) %>%
  summarise(
    avg_years_experience = mean(years_of_experience, na.rm = TRUE),
    avg_salary = mean(salary, na.rm = TRUE)
  )

# Просмотр результата
experience_salary_pivot

```

## Наблюдения:
1. Связь между уровнем образования и опытом работы:
Обладатели степени `PhD` имеют самый высокий средний опыт работы (13.9 лет), что значительно больше, чем у других уровней образования.
`Master's` также демонстрирует высокий средний опыт (9.65 лет), что почти в два раза больше, чем у тех, кто окончил только Bachelor's (5.42 года).
Выпускники `High School` имеют самый низкий средний опыт работы (1.92 года), что может быть связано с более ранним выходом на рынок труда.

2. Связь между уровнем образования и зарплатой:
Зарплата стабильно возрастает с ростом уровня образования:
Выпускники `High School` имеют самую низкую среднюю зарплату (36,707).
`Bachelor's` повышает среднюю зарплату почти в 3 раза по сравнению с `High School` (95,083).
`Master's` и `PhD` показывают самые высокие зарплаты — 130,112 и 165,651, соответственно.

3. Выводы:
Более высокий уровень образования связан как с большим количеством лет профессионального опыта, так и с более высоким уровнем дохода.
Это подтверждает, что инвестиции в высшее образование приводят к долгосрочным преимуществам для карьеры и дохода. Здесь хорошое место для рекламной интеграции HSE.

# 11.3 Зарплаты после 10 лет опыта
Мы сравним зарплаты `Data Scientist` с уровнями образования `Bachelor's` и `PhD`, которые имеют как минимум 10 лет опыта работы. Также проверим различия между мужчинами и женщинами в этих категориях.

Фильтрация данных
```{r data scientist filter}
# Фильтрация данных: только Data Scientists с уровнями образования Bachelor's и PhD, имеющие как минимум 10 лет опыта
filtered_data <- salary_data %>%
  filter(
    job_title == "Data Scientist",
    education_level %in% c("Bachelor's", "PhD"),
    years_of_experience >= 10
  )

# Группировка по уровню образования и полу, расчёт средней зарплаты
salary_comparison <- filtered_data %>%
  group_by(education_level, gender) %>%
  summarise(avg_salary = mean(salary, na.rm = TRUE)) %>%
  pivot_wider(names_from = gender, values_from = avg_salary)

# Просмотр результата
salary_comparison

```

Визуализация: Сравнение зарплат
```{r data scientist plot}
# Построение столбчатой диаграммы для сравнения зарплат
ggplot(filtered_data, aes(x = education_level, y = salary, fill = gender)) +
  stat_summary(fun = mean, geom = "bar", position = position_dodge(width = 0.8), width = 0.7, color = "black") +
  labs(
    title = "Сравнение зарплат Data Scientist с уровнями образования Bachelor's и PhD (10+ лет опыта)",
    x = "Уровень образования",
    y = "Средняя зарплата",
    fill = "Пол"
  ) +
  theme_minimal() +
  theme(axis.text.x = element_text(angle = 0, hjust = 0.5))

```

## Наблюдения:
1. Сравнение зарплат между уровнями образования:
Обладатели степени `PhD` стабильно зарабатывают больше, чем те, кто имеет степень `Bachelor's`.
Это подчёркивает значимость высшего уровня образования для высокооплачиваемых позиций, таких как Data Scientist.

2. Гендерные различия для PhD:
Среди обладателей степени `PhD`, женщины показывают чуть более высокую среднюю зарплату по сравнению с мужчинами.
Это может быть связано с наличием меньшего количества данных, что приводит к преобладанию высоких зарплат в выборке женщин.

3. Отсутствие женщин в категории `Bachelor's`:
В данных отсутствуют женщины с уровнем образования `Bachelor's` и более чем 10-летним опытом работы. Это ограничивает возможности анализа для этой категории.

4. Выводы:
Уровень `PhD` обеспечивает значительное увеличение средней зарплаты, независимо от пола.
Гендерные различия в категории `PhD` минимальны, что может говорить о более равномерной оплате труда на этом уровне образования.



# Основные выводы
1. Гендерный разрыв:
Мужчины чаще зарабатывают больше женщин на одинаковых позициях и уровнях образования, но в некоторых категориях, как `PhD`, разница минимальна или отсутствует.

2. Образование:
Высшее образование (особенно `PhD` и `Master's`) = выше зарплата. Но для некоторых ролей (`Software Engineer`) степень `Bachelor's` всё ещё конкурентоспособна.

3. Опыт работы:
Больше опыта = больше денег, но не всегда. Например, есть роли, где высокий доход доступен даже с меньшим опытом.

4. Экзамены:
Результаты по математике и программированию почти не влияют на зарплату. Рынок ценит реальные навыки и опыт, а не академические баллы.

# Итоги:
Высшее образование помогает, но не всегда определяет уровень дохода.
Гендерный разрыв всё ещё существует, особенно на высокооплачиваемых должностях.
Опыт и навыки остаются ключевыми для роста зарплаты.